-- LocalScript: InfiniteStamina.lua
local player = game.Players.LocalPlayer

-- Tên giá trị stamina trong game của bạn (có thể là IntValue/NumberValue)
local STAMINA_NAME = "Stamina"      -- đổi nếu game bạn dùng tên khác
local MAX_STAMINA = 100             -- đổi theo max thực tế
local REFILL_RATE = 10              -- số đơn vị / giây (tùy chỉnh)

local enabled = true                -- toggle mặc định

-- Helper: lấy stamina value (chờ nếu chưa có)
local function getStamina()
    -- thường Stamina để trong Player hoặc trong Character; kiểm tra cả hai
    local s = player:FindFirstChild(STAMINA_NAME)
    if s then return s end

    local character = player.Character
    if character then
        s = character:FindFirstChild(STAMINA_NAME)
        if s then return s end
    end

    -- nếu chưa có, chờ Player thêm nó (thử trong 5s)
    s = player:WaitForChild(STAMINA_NAME, 5) -- nếu hết 5s sẽ lỗi
    return s
end

-- An toàn: bắt lỗi trường hợp không tìm thấy
local ok, stamina = pcall(getStamina)
if not ok or not stamina then
    warn("InfiniteStamina: Không tìm thấy giá trị '"..STAMINA_NAME.."'. Tạo 1 NumberValue/IntValue tên đó trong Player hoặc Character.")
    return
end

-- GUI toggle đơn giản (không bắt buộc)
local StarterGui = game:GetService("StarterGui")
-- Tạo một ScreenGui nhỏ cho toggle (chỉ client)
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "InfiniteStaminaToggle"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

local button = Instance.new("TextButton")
button.Size = UDim2.new(0,140,0,40)
button.Position = UDim2.new(0,10,0,10)
button.Text = "Inf Stamina: ON"
button.Parent = screenGui

button.MouseButton1Click:Connect(function()
    enabled = not enabled
    button.Text = "Inf Stamina: " .. (enabled and "ON" or "OFF")
end)

-- Vòng lặp refill (an toàn, gọn)
local runService = game:GetService("RunService")
local last = tick()
runService.Heartbeat:Connect(function(dt)
    if not enabled then return end

    -- Nếu giá trị là NumberValue/IntValue, set gần bằng max (theo rate)
    if stamina.Value < MAX_STAMINA then
        local add = REFILL_RATE * dt
        stamina.Value = math.min(MAX_STAMINA, stamina.Value + add)
    else
        -- giữ chính xác = MAX_STAMINA (tránh dao động)
        stamina.Value = MAX_STAMINA
    end
end)
